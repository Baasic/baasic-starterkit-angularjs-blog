<form name="menuForm" novalidate ng-submit="save()">
    <label>Title</label>
    <input type="text" name="name" ng-model="menu.name" required />
    <p ng-show="(menuForm.$submitted || menuForm.title.$touched) && menuForm.name.$error.required">Name is required.</p>
    
    <fieldset>
        <legend>Items</legend>
        <div>
            <label>Pages</label>
            <button type="button">Add new</button>
            <ul>
                <li ng-repeat="page in pages">
                    <input type="checkbox" ng-click="addPageToMenu(page)" /> {{ page.title }}
                </li>
            </ul>
            
        </div>
        <div>
            <label>Containers</label>
            <button type="button" ng-click="toggleAddContainer()">{{ addingNewContainer ? 'Cancel' : 'Add new' }}</button>
            <div ng-form="addContainerForm" ng-if="addingNewContainer">
                <label>Title</label>
                <input type="text" name="title" ng-model="newContainer.title" />
                <button type="button" ng-click="addContainer()">Save</button>
            </div>
            <ul>
                <li ng-repeat="container in menu.containers">
                    <input type="checkbox" /> <span contenteditable ng-model="container.title"></span> <button type="button" ng-click="removeContainer(container)">X</button>
                </li>
            </ul>
        </div>
        <div>
            <label>Links</label>
            <button type="button" ng-click="toggleAddLink()">{{ addingNewLink ? 'Cancel' : 'Add new' }}</button>
            <div ng-form="addContainerForm" ng-if="addingNewLink">
                <label>Title</label>
                <input type="text" name="title" ng-model="newLink.title" />
                <label>Link</label>
                <input type="text" name="url" ng-model="newLink.url" />
                <button type="button" ng-click="addLink()">Save</button>
            </div>
            <ul>
                <li ng-repeat="link in menu.links">
                    <input type="checkbox" /> <span contenteditable ng-model="link.title"></span> <button type="button" ng-click="removeLink(link)">X</button>
                </li>
            </ul>
        </div>
    </fieldset>

    <div ui-tree>
        <ol ui-tree-nodes="" ng-model="menu.items">
            <li ng-repeat="item in menu.items" ui-tree-node>
                <div ui-tree-handle>
                    {{item.title}}
                </div>
                <ol ui-tree-nodes="" ng-model="item.items">
                    <li ng-repeat="subItem in item.items" ui-tree-node>
                        <div ui-tree-handle>
                            {{subItem.title}}
                        </div>
                    </li>
                </ol>
            </li>
        </ol>
    </div>

    <button type="submit">Save</button>

    <div ng-show="error">
        {{ error }}
    </div>
</form>
